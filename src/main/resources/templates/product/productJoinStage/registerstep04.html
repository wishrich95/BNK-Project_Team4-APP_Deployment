<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>TKë”¸ê¹ì€í–‰::ê°€ì… ì™„ë£Œ</title>

    <link rel="stylesheet" th:href="@{/css/common/style_common.css}">
    <link rel="stylesheet" th:href="@{/css/common/style_font.css}">
    <link href="//cdn.jsdelivr.net/xeicon/2/xeicon.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/_header.css}">
    <link rel="stylesheet" th:href="@{/css/cs/chat.css}">
    <link rel="stylesheet" th:href="@{/css/_footer.css}">
    <link rel="stylesheet" th:href="@{/css/member/AutoLogout.css}">

    <script th:src="@{/js/cs/openChat.js}" defer></script>

    <style>
        :root {
            --red-900: #6A1B9A;
            --red-700: #d3c8ef;
            --red-100: #F3E8FF;
            --white: #ffffff;
            --grey-900: #333333;
            --grey-700: #666666;
            --grey-500: #B9B9B9;
            --grey-400: #B0B0B0;
            --grey-300: #DEDEDE;
            --grey-100: #F8F8F8;
            --container: 1200px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Noto Sans KR', sans-serif; color: var(--grey-900); min-width: 1200px; }

        .container { max-width: var(--container); margin: 0 auto; padding: 0 20px; }
        a { color: inherit; text-decoration: none; }

        /* ìƒë‹¨ ìœ í‹¸, GNB ì˜ì—­ */

        /* ì½˜í…ì¸  ì˜ì—­ */
        .content-area {
            min-height: 60vh;
            padding: 50px 0;
            display: flex;
            justify-content: center;
        }

        .complete-wrap { width: 800px; }

        .title-step { color: var(--red-900); font-size: 1.1rem; font-weight: 700; margin-bottom: 10px; }
        .title-main { font-size: 2rem; font-weight: 700; line-height: 1.4; margin-bottom: 40px; color: var(--grey-900); }

        /* ê´‘ê³  ë°°ë„ˆ ìºëŸ¬ì…€ */
        .ad-banner-carousel {
            position: relative;
            width: 100%;
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .ad-banner-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .ad-banner-slide {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
        }

        .ad-banner-slide.active {
            opacity: 1;
            pointer-events: auto;
        }

        .ad-banner-bg {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .ad-banner-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(120, 90, 255, 0.35) 0%, rgba(80, 140, 255, 0.28) 100%);
            display: flex;
            align-items: center;
            padding: 60px;
        }

        .ad-banner-text {
            max-width: 600px;
            background-color: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .ad-banner-text h3 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .ad-banner-text p {
            font-size: 1.2rem;
            color: var(--white);
            margin-bottom: 25px;
            line-height: 1.6;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .ad-banner-btn {
            display: inline-block;
            padding: 12px 35px;
            background-color: var(--white);
            color: var(--red-900);
            border-radius: 30px;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .ad-banner-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        /* ì´ì „/ë‹¤ìŒ ë²„íŠ¼ */
        .ad-banner-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background-color: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--red-900);
            transition: all 0.3s;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .ad-banner-nav:hover {
            background-color: var(--white);
            transform: translateY(-50%) scale(1.1);
        }

        .ad-banner-prev {
            left: 20px;
        }

        .ad-banner-next {
            right: 20px;
        }

        /* ì¸ë””ì¼€ì´í„° */
        .ad-banner-indicators {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }

        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s;
        }

        .indicator:hover {
            background-color: rgba(255, 255, 255, 0.8);
        }

        .indicator.active {
            width: 30px;
            border-radius: 6px;
            background-color: var(--white);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--grey-900);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--grey-900);
        }

        /* ìƒí’ˆ ì¹´ë“œ */
        .product-card {
            background-color: var(--white);
            border: 2px solid var(--grey-300);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }
        .product-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--red-900);
            margin-bottom: 20px;
        }
        .product-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .product-info-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .product-info-label {
            font-size: 0.9rem;
            color: var(--grey-700);
        }
        .product-info-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--grey-900);
        }
        .product-info-value.highlight {
            color: var(--red-900);
            font-size: 1.3rem;
        }

        /* ê¸ˆë¦¬ ë°•ìŠ¤ */
        .rate-box {
            background: linear-gradient(135deg, var(--red-900), var(--red-700));
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            color: var(--white);
            margin-bottom: 30px;
        }
        .rate-box-title {
            font-size: 1rem;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        .rate-box-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .rate-box-desc {
            font-size: 0.95rem;
            opacity: 0.85;
        }

        /* ìš°ëŒ€ê¸ˆë¦¬ ì•ˆë‚´ */
        .preferential-info {
            background-color: var(--grey-100);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .preferential-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--grey-900);
            margin-bottom: 15px;
        }
        .preferential-list {
            list-style: none;
        }
        .preferential-list li {
            padding: 10px 0;
            border-bottom: 1px dashed var(--grey-300);
            display: flex;
            justify-content: space-between;
            font-size: 0.95rem;
        }
        .preferential-list li:last-child {
            border-bottom: none;
        }
        .preferential-condition {
            color: var(--grey-700);
        }
        .preferential-rate {
            color: var(--red-900);
            font-weight: 700;
        }

        /* ì•ˆë‚´ì‚¬í•­ */
        .notice-box {
            background-color: var(--grey-100);
            border-left: 4px solid var(--red-900);
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .notice-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--grey-900);
            margin-bottom: 12px;
        }
        .notice-list {
            list-style: none;
            font-size: 0.9rem;
            color: var(--grey-700);
            line-height: 1.8;
        }
        .notice-list li {
            padding-left: 15px;
            position: relative;
            margin-bottom: 8px;
        }
        .notice-list li:before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: var(--red-900);
            font-weight: 700;
        }

        /* ìƒí’ˆì„¤ëª…ì„œ ë° ì•½ê´€ */
        .document-links {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        .document-link {
            flex: 1;
            padding: 15px;
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            text-align: center;
            text-decoration: none;
            color: var(--grey-700);
            transition: all 0.3s;
            cursor: pointer;
            background-color: var(--white);
        }
        .document-link:hover {
            border-color: var(--grey-500);
            background-color: var(--grey-100);
        }
        .document-link-icon {
            font-size: 2rem;
            margin-bottom: 8px;
            color: var(--grey-500);
            transition: all 0.3s;
        }
        .document-link-text {
            font-size: 0.95rem;
            font-weight: 600;
        }
        .document-link.confirmed {
            border-color: var(--red-900);
            background-color: var(--red-100);
            color: var(--red-900);
        }
        .document-link.confirmed:hover {
            border-color: var(--red-700);
            background-color: var(--red-100);
        }
        .document-link.confirmed .document-link-icon {
            color: var(--red-900);
        }

        /* ìµœì¢… ê°€ì… ë²„íŠ¼ */
        .final-button-area {
            margin-top: 40px;
            text-align: center;
        }
        .btn-complete {
            width: 100%;
            padding: 18px 0;
            background-color: var(--grey-300);
            color: var(--grey-700);
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: not-allowed;
            transition: all 0.3s;
        }
        .btn-complete.active {
            background-color: var(--red-900);
            color: var(--white);
            cursor: pointer;
        }
        .btn-complete.active:hover {
            background-color: var(--red-700);
        }

        /* ìƒë‹´ ë²„íŠ¼ */
        .contact-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        .contact-btn {
            flex: 1;
            padding: 20px;
            background-color: var(--white);
            border: 1px solid var(--grey-300);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .contact-btn:hover {
            border-color: var(--red-900);
            background-color: var(--red-100);
        }
        .contact-btn i {
            font-size: 2rem;
            color: var(--red-900);
        }

        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: var(--white);
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--grey-300);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--grey-900);
        }
        .close-btn {
            font-size: 2rem;
            color: var(--grey-500);
            cursor: pointer;
        }
        .close-btn:hover {
            color: var(--grey-900);
        }
        .modal-body {
            padding: 30px;
            line-height: 1.8;
        }
        .modal-body h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--grey-900);
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .modal-body p {
            color: var(--grey-700);
            margin-bottom: 15px;
        }
        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--grey-300);
            text-align: center;
        }
        .btn-primary {
            padding: 12px 40px;
            background-color: var(--red-900);
            color: var(--white);
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
        }
        .btn-primary:hover {
            background-color: var(--red-700);
        }

        /* ê°€ì… ì™„ë£Œ ëª¨ë‹¬ */
        .complete-modal-content {
            width: 400px;
            padding: 40px;
            text-align: center;
        }
        .modal-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--grey-900);
            margin-bottom: 20px;
        }
        .modal-text {
            font-size: 1rem;
            color: var(--grey-700);
            line-height: 1.6;
            margin-bottom: 30px;
        }
        .modal-btn {
            width: 100%;
            padding: 15px;
            background-color: var(--red-900);
            color: var(--white);
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
        }
        .modal-btn:hover {
            background-color: var(--red-700);
        }
    </style>

    <script th:src="@{/js/gnbDropdown.js}" defer></script>
    <script th:src="@{/js/translate.js}" defer></script>
    <script th:src="@{/js/globalBtn.js}" defer></script>
    <script th:src="@{/js/searchOverlay.js}" defer></script>
    <script th:src="@{/js/member/session-timer.js}" defer></script>
</head>

<body>

<div th:replace="~{_header :: headerFragment}"></div>
<!-- ìƒë‹¨ ì˜ì—­ -->


<!-- ë©”ì¸ ì»¨í…ì¸  -->
<section class="container content-area">
    <div class="complete-wrap">
        <p class="title-step">STEP 4/4</p>
        <h2 class="title-main">ê°€ì…ì„ ì™„ë£Œí•˜ê¸° ì „,<br>ìƒí’ˆ ì •ë³´ë¥¼ ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•´ì£¼ì„¸ìš”.</h2>

        <!-- âœ… form íƒœê·¸ ì‹œì‘ -->
        <form th:action="@{/prod/productjoin/complete}" method="post" id="completeForm">

            <!-- âœ… hidden inputs: ëª¨ë“  ë°ì´í„° ì „ì†¡ -->
            <input type="hidden" name="productNo" th:value="${joinRequest.productNo}">
            <input type="hidden" name="userId" th:value="${joinRequest.userId}">
            <input type="hidden" name="principalAmount" th:value="${joinRequest.principalAmount}">
            <input type="hidden" name="contractTerm" th:value="${joinRequest.contractTerm}">
            <input type="hidden" name="startDate" th:value="${joinRequest.startDate}">
            <input type="hidden" name="expectedEndDate" th:value="${joinRequest.expectedEndDate}">
            <input type="hidden" name="applyRate" th:value="${joinRequest.applyRate}">
            <input type="hidden" name="earlyTerminateRate" th:value="${joinRequest.earlyTerminateRate}">
            <input type="hidden" name="branchId" th:value="${joinRequest.branchId}">
            <input type="hidden" name="empId" th:value="${joinRequest.empId}">
            <input type="hidden" name="notificationSms" th:value="${joinRequest.notificationSms}">
            <input type="hidden" name="notificationEmail" th:value="${joinRequest.notificationEmail}">
            <input type="hidden" name="notificationHp" th:value="${joinRequest.notificationHp}">
            <input type="hidden" name="notificationEmailAddr" th:value="${joinRequest.notificationEmailAddr}">
            <input type="hidden" name="accountPassword" th:value="${joinRequest.accountPassword}">
            <input type="hidden" name="finalAgree" id="finalAgree" value="false">
            <!-- ê²Œì„í¬ì¸íŠ¸ ì¶”ê°€ -->
            <input type="hidden" name="userPoints" th:value="${joinRequest.userPoints}">
            <input type="hidden" name="pointBonusRate" th:value="${joinRequest.pointBonusRate}">


            <!-- ê´‘ê³  ë°°ë„ˆ (ìºëŸ¬ì…€) -->
            <div class="ad-banner-carousel">
                <div class="ad-banner-wrapper">
                    <!-- ìŠ¬ë¼ì´ë“œ 1 -->
                    <div class="ad-banner-slide active">
                        <img th:src="@{/images/product/deposit.jpg}" alt="ì˜ˆê¸ˆ ê´‘ê³  1" class="ad-banner-bg">
                        <div class="ad-banner-overlay">
                            <div class="ad-banner-text">
                                <h3>BNK ë¶€ì‚°ì€í–‰ íŠ¹íŒ ì •ê¸°ì˜ˆê¸ˆ</h3>
                                <p>ì§€ê¸ˆ ê°€ì…í•˜ë©´ ìµœëŒ€ ì—° 3.5% ìš°ëŒ€ê¸ˆë¦¬ í˜œíƒ!</p>
                                <a href="#" class="ad-banner-btn">ìì„¸íˆ ë³´ê¸°</a>
                            </div>
                        </div>
                    </div>

                    <!-- ìŠ¬ë¼ì´ë“œ 2 -->
                    <div class="ad-banner-slide">
                        <img th:src="@{/images/product/nasdaq.png}" alt="ì˜ˆê¸ˆ ê´‘ê³  2" class="ad-banner-bg">
                        <div class="ad-banner-overlay">
                            <div class="ad-banner-text">
                                <h3>ë¶€ì‚°ì€í–‰ Myí”ŒëŸ¬ìŠ¤ ì •ê¸°ì˜ˆê¸ˆ</h3>
                                <p>ì‹ ê·œ ê³ ê° íŠ¹ë³„ ìš°ëŒ€! ìµœëŒ€ ì—° 3.2% ê¸ˆë¦¬</p>
                                <a href="#" class="ad-banner-btn">ìì„¸íˆ ë³´ê¸°</a>
                            </div>
                        </div>
                    </div>

                    <!-- ìŠ¬ë¼ì´ë“œ 3 -->
                    <div class="ad-banner-slide">
                        <img th:src="@{/images/product/crudeoil.jpg}" alt="ì˜ˆê¸ˆ ê´‘ê³  3" class="ad-banner-bg">
                        <div class="ad-banner-overlay">
                            <div class="ad-banner-text">
                                <h3>ì²­ë…„ ìš°ëŒ€ ì •ê¸°ì˜ˆê¸ˆ</h3>
                                <p>ë§Œ 34ì„¸ ì´í•˜ ê³ ê° ì „ìš©! ì—° 4.0% íŠ¹ë³„ ê¸ˆë¦¬</p>
                                <a href="#" class="ad-banner-btn">ìì„¸íˆ ë³´ê¸°</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì´ì „/ë‹¤ìŒ ë²„íŠ¼ -->
                <button type="button" class="ad-banner-nav ad-banner-prev" onclick="changeSlide(-1)">
                    <i class="xi-angle-left"></i>
                </button>
                <button type="button" class="ad-banner-nav ad-banner-next" onclick="changeSlide(1)">
                    <i class="xi-angle-right"></i>
                </button>

                <!-- ì¸ë””ì¼€ì´í„° -->
                <div class="ad-banner-indicators">
                    <span class="indicator active" onclick="goToSlide(0)"></span>
                    <span class="indicator" onclick="goToSlide(1)"></span>
                    <span class="indicator" onclick="goToSlide(2)"></span>
                </div>
            </div>

            <!-- ìƒí’ˆ ì•ˆë‚´ âœ… í¬ì¸íŠ¸ ì •ë³´ ì¶”ê°€ -->
            <h3 class="section-title">ìƒí’ˆ ì•ˆë‚´</h3>
            <div class="product-card">
                <div class="product-name" th:text="${joinRequest.productName}">ìƒí’ˆëª…</div>
                <div class="product-info-grid">
                    <div class="product-info-item">
                        <span class="product-info-label">ê°€ì… ê¸ˆì•¡</span>
                        <span class="product-info-value" th:text="${#numbers.formatInteger(joinRequest.principalAmount, 0, 'COMMA')} + 'ì›'">1,000,000ì›</span>
                    </div>
                    <div class="product-info-item">
                        <span class="product-info-label">ê°€ì… ê¸°ê°„</span>
                        <span class="product-info-value" th:text="${joinRequest.contractTerm} + 'ê°œì›”'">12ê°œì›”</span>
                    </div>

                    <!-- âœ… ì„ íƒí•œ í¬ì¸íŠ¸ ì •ë³´ ì¶”ê°€ -->
                    <div class="product-info-item" style="background-color: #FFF9E6; padding: 10px; border-radius: 6px; border: 2px solid #FFB800;">
                        <span class="product-info-label">ì‚¬ìš©í•œ í¬ì¸íŠ¸</span>
                        <span class="product-info-value" style="color: #FFB800; font-weight: 700;" th:text="${joinRequest.usedPoints} + ' P'">1,200 P</span>
                    </div>

                    <div class="product-info-item">
                        <span class="product-info-label">ê¸°ë³¸ ì´ìœ¨</span>
                        <span class="product-info-value" th:text="'ì—° ' + ${joinRequest.baseRate} + '%'">ì—° 3.50%</span>
                    </div>

                    <!-- âœ… í¬ì¸íŠ¸ ê¸ˆë¦¬ í‘œì‹œ -->
                    <div class="product-info-item" style="background-color: #FFF9E6; padding: 10px; border-radius: 6px;">
                        <span class="product-info-label">í¬ì¸íŠ¸ ì¶”ê°€ ê¸ˆë¦¬</span>
                        <span class="product-info-value highlight" style="color: #FFB800;" th:text="'+ ' + ${joinRequest.pointBonusRate} + '%'">+ 1.20%</span>
                    </div>

                    <!-- âœ… ìµœì¢… ì ìš© ê¸ˆë¦¬ -->
                    <div class="product-info-item" style="background-color: #FAE5E6; padding: 10px; border-radius: 6px;">
                        <span class="product-info-label">ìµœì¢… ì ìš© ì´ìœ¨</span>
                        <span class="product-info-value highlight" th:text="'ì—° ' + ${joinRequest.applyRate} + '%'">ì—° 4.70%</span>
                    </div>
                </div>
            </div>

            <!-- ìµœì¢… ì ìš© ê¸ˆë¦¬ ë°•ìŠ¤ ìˆ˜ì • -->
            <h3 class="section-title">ìµœì¢… ì ìš© ê¸ˆë¦¬</h3>
            <div class="rate-box">
                <div class="rate-box-title">ê³ ê°ë‹˜ê»˜ ì ìš©ë˜ëŠ” ìµœì¢… ê¸ˆë¦¬</div>
                <div class="rate-box-value" th:text="'ì—° ' + ${joinRequest.applyRate} + '%'">ì—° 4.70%</div>
                <div class="rate-box-desc">
                    ê¸°ë³¸ê¸ˆë¦¬ <span th:text="${joinRequest.baseRate} + '%'">3.50%</span> +
                    í¬ì¸íŠ¸ê¸ˆë¦¬ <span th:text="${joinRequest.pointBonusRate} + '%'">1.20%</span>
                    <span th:if="${joinRequest.couponBonusRate != null and joinRequest.couponBonusRate > 0}">
                        + ì¿ í°ê¸ˆë¦¬ <span th:text="${joinRequest.couponBonusRate} + '%'">5.0%</span>
                    </span>
                    <br>
                    (ì‚¬ìš© í¬ì¸íŠ¸ <span th:text="${joinRequest.usedPoints} + 'P'">1,200P</span> - 100ì ë‹¹ 0.1% ìš°ëŒ€
                    <span th:if="${joinRequest.couponBonusRate != null and joinRequest.couponBonusRate > 0}">
                        / ê²Œì„ ì¿ í° <span th:text="${joinRequest.couponBonusRate} + '%'">5.0%</span> ì ìš©
                    </span>)
                </div>
            </div>

            <!-- âœ… í¬ì¸íŠ¸+ì¿ í° ì•ˆë‚´ ë°•ìŠ¤ ìˆ˜ì • -->
            <div class="notice-box" style="border-left: 4px solid #FFB800; background-color: #FFF9E6;">
                <div class="notice-title">ğŸ í¬ì¸íŠ¸ + ì¿ í° ê¸ˆë¦¬ ìš°ëŒ€ ì ìš© ë‚´ì—­</div>
                <ul class="notice-list">
                    <li>ì‚¬ìš© í¬ì¸íŠ¸: <strong th:text="${joinRequest.usedPoints} + ' P'">100 P</strong></li>
                    <li>í¬ì¸íŠ¸ ê¸ˆë¦¬ ìš°ëŒ€: <strong th:text="${joinRequest.pointBonusRate} + '%'">0.10%</strong> (100ì ë‹¹ 0.1% ì ìš©)</li>
                    <li th:if="${joinRequest.couponBonusRate != null and joinRequest.couponBonusRate > 0}">
                        ê²Œì„ ì¿ í° ê¸ˆë¦¬ ìš°ëŒ€: <strong style="color: #E1545A;" th:text="${joinRequest.couponBonusRate} + '%'">5.0%</strong>
                    </li>
                    <li>ìµœì¢… ì ìš© ê¸ˆë¦¬:
                        ê¸°ë³¸ê¸ˆë¦¬ <span th:text="${joinRequest.baseRate} + '%'">3.50%</span> +
                        í¬ì¸íŠ¸ê¸ˆë¦¬ <span th:text="${joinRequest.pointBonusRate} + '%'">0.10%</span>
                        <span th:if="${joinRequest.couponBonusRate != null and joinRequest.couponBonusRate > 0}">
                            + ì¿ í°ê¸ˆë¦¬ <span th:text="${joinRequest.couponBonusRate} + '%'">5.0%</span>
                        </span>
                        = <strong style="color: #E1545A;" th:text="${joinRequest.applyRate} + '%'">8.60%</strong>
                    </li>
                    <li>âœ¨ í¬ì¸íŠ¸ëŠ” ê°€ì… ì™„ë£Œ ì‹œ ì°¨ê°ë˜ë©°, ì¿ í°ì€ ì‚¬ìš© ì²˜ë¦¬ë©ë‹ˆë‹¤</li>
                </ul>
            </div>

            <!-- hidden inputs ì¶”ê°€ -->
            <input type="hidden" name="usedPoints" th:value="${joinRequest.usedPoints}">
            <input type="hidden" name="selectedCouponId" th:value="${joinRequest.selectedCouponId}">
            <input type="hidden" name="couponBonusRate" th:value="${joinRequest.couponBonusRate}">
            <input type="hidden" name="pointBonusRate" th:value="${joinRequest.pointBonusRate}">

            <!-- ì¤‘ìš” ì•ˆë‚´ì‚¬í•­ -->
            <h3 class="section-title">ì¤‘ìš” ì•ˆë‚´ì‚¬í•­</h3>
            <div class="notice-box">
                <div class="notice-title">âš ï¸ ê¼­ í™•ì¸í•´ì£¼ì„¸ìš”</div>
                <ul class="notice-list">
                    <li>ì˜ˆê¸ˆìë³´í˜¸ë²•ì— ë”°ë¼ ì˜ˆê¸ˆë³´í—˜ê³µì‚¬ê°€ ë³´í˜¸í•˜ë˜, ë³¸ ì€í–‰ì— ìˆëŠ” ëª¨ë“  ì˜ˆê¸ˆë³´í˜¸ ëŒ€ìƒ ê¸ˆìœµìƒí’ˆì˜ ì›ê¸ˆê³¼ ì†Œì •ì˜ ì´ìë¥¼ í•©í•˜ì—¬ 1ì¸ë‹¹ "ìµœê³  5ì²œë§Œì›"ê¹Œì§€ ë³´í˜¸í•©ë‹ˆë‹¤.</li>
                    <li>ë§Œê¸° ì „ ì¤‘ë„í•´ì§€ ì‹œ ì¤‘ë„í•´ì§€ì´ìœ¨ì´ ì ìš©ë˜ì–´ ì´ì ìˆ˜ë ¹ì•¡ì´ ì¤„ì–´ë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    <li>ì´ìì†Œë“ì— ëŒ€í•´ì„œëŠ” ì†Œë“ì„¸ë²•ì— ë”°ë¼ ì´ìì†Œë“ì„¸(15.4%)ê°€ ì›ì²œì§•ìˆ˜ë©ë‹ˆë‹¤.</li>
                    <li>ë§Œê¸°ì¼ì´ ì˜ì—…ì¼ì´ ì•„ë‹Œ ê²½ìš° ì „ ì˜ì—…ì¼ì— ë§Œê¸°ì²˜ë¦¬ ë©ë‹ˆë‹¤.</li>
                </ul>
            </div>

            <!-- ìƒí’ˆì„¤ëª…ì„œ ë° ì•½ê´€ -->
            <!-- ì‘ì„±ì: ì§„ì›, 2025-11-29, PDF ë³´ê¸° ë²„íŠ¼ ì¶”ê°€ -->
            <h3 class="section-title">í•„ìˆ˜ í™•ì¸ ì„œë¥˜</h3>
            <div class="document-links">
                <div class="document-link" data-doc="productGuide" onclick="openModal('productGuideModal', 'productGuide')">
                    <div class="document-link-icon">ğŸ“„</div>
                    <div class="document-link-text">ìƒí’ˆì„¤ëª…ì„œ</div>
                    <div style="margin-top: 8px;">
                        <a th:href="@{/prod/productjoin/document/productGuide(productNo=${joinRequest.productNo})}"
                           target="_blank"
                           onclick="event.stopPropagation();"
                           style="font-size: 0.85rem; color: var(--red-900); text-decoration: underline;">
                            ğŸ“¥ PDF ë³´ê¸°
                        </a>
                    </div>
                </div>
                <div class="document-link" data-doc="terms" onclick="openModal('termsModal', 'terms')">
                    <div class="document-link-icon">ğŸ“‹</div>
                    <div class="document-link-text">ì•½ê´€</div>
                    <div style="margin-top: 8px;">
                        <a th:href="@{/prod/productjoin/document/terms(productNo=${joinRequest.productNo})}"
                           target="_blank"
                           onclick="event.stopPropagation();"
                           style="font-size: 0.85rem; color: var(--red-900); text-decoration: underline;">
                            ğŸ“¥ PDF ë³´ê¸°
                        </a>
                    </div>
                </div>
                <div class="document-link" data-doc="rateGuide" onclick="openModal('rateGuideModal', 'rateGuide')">
                    <div class="document-link-icon">ğŸ’°</div>
                    <div class="document-link-text">ê¸ˆë¦¬ ì•ˆë‚´</div>
                    <div style="margin-top: 8px;">
                        <a th:href="@{/prod/productjoin/document/rateGuide(productNo=${joinRequest.productNo})}"
                           target="_blank"
                           onclick="event.stopPropagation();"
                           style="font-size: 0.85rem; color: var(--red-900); text-decoration: underline;">
                            ğŸ“¥ PDF ë³´ê¸°
                        </a>
                    </div>
                </div>
            </div>

            <!-- ìƒë‹´ ì•ˆë‚´ -->
            <h3 class="section-title">ë¬¸ì˜í•˜ê¸°</h3>
            <div class="contact-buttons">
                <button type="button" class="contact-btn" onclick="alert('ì „í™”ìƒë‹´ ì—°ê²°: 1588-xxxx')">
                    <i class="xi-phone"></i>
                    <span>ì „í™” ìƒë‹´<br><small style="font-size: 0.8rem; color: var(--grey-700);">1588-xxxx</small></span>
                </button>
                <!-- 11/30 ì±„íŒ… ì›¹ì†Œì¼“ ì—°ê²° -->
                <button type="button"
                        class="contact-btn"
                        id="productChatBtn"
                        data-inquiry-type="ìƒí’ˆ ê°€ì…">
                    <i class="xi-message"></i>
                    <span>ìƒë‹´ í•˜ê¸°<br><small style="font-size: 0.8rem; color: var(--grey-700);">í‰ì¼ 09:00 ~ 18:00</small></span>
                </button>
            </div>

            <!-- ìµœì¢… ê°€ì…í•˜ê¸° ë²„íŠ¼ -->
            <div class="final-button-area">
                <button type="button" class="btn-complete" onclick="submitJoin()">
                    ê°€ì…í•˜ê¸°
                </button>
            </div>
        </form>
        <!-- âœ… form íƒœê·¸ ë -->
    </div>
</section>

<!-- ìƒí’ˆì„¤ëª…ì„œ ëª¨ë‹¬ -->
<div id="productGuideModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>ìƒí’ˆ ì„¤ëª…ì„œ</h2>
            <span class="close-btn" onclick="closeModal('productGuideModal')">&times;</span>
        </div>
        <div class="modal-body">
            <h4>1. ìƒí’ˆ ê°œìš”</h4>
            <p>ê³ ê°ë‹˜ì˜ ì—¬ìœ  ìê¸ˆì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ë©´ì„œ ìš°ëŒ€ê¸ˆë¦¬ í˜œíƒì„ í†µí•´ ë” ë†’ì€ ìˆ˜ìµì„ ì–»ì„ ìˆ˜ ìˆëŠ” ì •ê¸°ì˜ˆê¸ˆ ìƒí’ˆì…ë‹ˆë‹¤.</p>

            <h4>2. ê°€ì… ëŒ€ìƒ</h4>
            <p>- ì‹¤ëª…ì˜ ê°œì¸ ë° ê°œì¸ì‚¬ì—…ì<br>
                - ë§Œ 19ì„¸ ì´ìƒ ì„±ì¸<br>
                - ë‚´Â·ì™¸êµ­ì¸ ëª¨ë‘ ê°€ì… ê°€ëŠ¥</p>

            <h4>3. ê°€ì… ê¸ˆì•¡ ë° ê¸°ê°„</h4>
            <p>- ìµœì†Œ ê°€ì…ê¸ˆì•¡: 100,000ì› ì´ìƒ<br>
                - ê°€ì… ê¸°ê°„: 1ê°œì›” ~ 60ê°œì›”</p>

            <h4>4. ì˜ˆê¸ˆì ë³´í˜¸</h4>
            <p>ì´ ì˜ˆê¸ˆì€ ì˜ˆê¸ˆìë³´í˜¸ë²•ì— ë”°ë¼ ì˜ˆê¸ˆë³´í—˜ê³µì‚¬ê°€ ë³´í˜¸í•˜ë˜, ë³¸ ì€í–‰ì˜ ëª¨ë“  ì˜ˆê¸ˆë³´í˜¸ ëŒ€ìƒ ê¸ˆìœµìƒí’ˆì˜ ì›ê¸ˆê³¼ ì†Œì •ì˜ ì´ìë¥¼ í•©í•˜ì—¬ 1ì¸ë‹¹ <strong>ìµœê³  5ì²œë§Œì›</strong>ê¹Œì§€ ë³´í˜¸ë©ë‹ˆë‹¤.</p>
        </div>
        <div class="modal-footer">
            <button class="btn-primary" onclick="confirmDocument('productGuideModal', 'productGuide')">í™•ì¸</button>
        </div>
    </div>
</div>

<!-- ì•½ê´€ ëª¨ë‹¬ -->
<div id="termsModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>ì˜ˆê¸ˆê±°ë˜ ê¸°ë³¸ì•½ê´€</h2>
            <span class="close-btn" onclick="closeModal('termsModal')">&times;</span>
        </div>
        <div class="modal-body">
            <h4>ì œ1ì¡° (ì•½ê´€ì˜ ì ìš©)</h4>
            <p>â‘  ì€í–‰ê³¼ ì˜ˆê¸ˆê±°ë˜ë¥¼ í•˜ëŠ” ê³ ê°ì€ ì´ ì•½ê´€ì— ë”°ë¥´ê¸°ë¡œ í•©ë‹ˆë‹¤.<br>
                â‘¡ ì´ ì•½ê´€ì—ì„œ ì •í•˜ì§€ ì•Šì€ ì‚¬í•­ì€ ê´€ê³„ë²•ë ¹ì— ë”°ë¦…ë‹ˆë‹¤.</p>

            <h4>ì œ2ì¡° (ì˜ˆê¸ˆê³„ì•½ì˜ ì„±ë¦½)</h4>
            <p>ì˜ˆê¸ˆê³„ì•½ì€ ì˜ˆê¸ˆìê°€ ì€í–‰ì´ ì •í•œ ì˜ˆê¸ˆì‹ ì²­ì„œì— ê¸°ëª…ë‚ ì¸ ë˜ëŠ” ì„œëª…í•˜ê³  ì¼ì •í•œ ê¸ˆì•¡ì„ ì…ê¸ˆí•¨ìœ¼ë¡œì¨ ì„±ë¦½í•©ë‹ˆë‹¤.</p>

            <h4>ì œ3ì¡° (ì´ì)</h4>
            <p>ì´ìëŠ” ì˜ˆê¸ˆì¢…ë¥˜ë³„ ì•½ì •ì´ìœ¨ì— ë”°ë¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>

            <h4>ì œ4ì¡° (ì˜ˆê¸ˆìë³´í˜¸)</h4>
            <p>ì´ ì˜ˆê¸ˆì€ ì˜ˆê¸ˆìë³´í˜¸ë²•ì— ë”°ë¼ ë³´í˜¸ë©ë‹ˆë‹¤. ë‹¤ë§Œ, ë³´í˜¸ í•œë„ëŠ” 1ì¸ë‹¹ ìµœê³  5ì²œë§Œì›ì´ë©°, ì´ˆê³¼í•˜ëŠ” ê¸ˆì•¡ì€ ë³´í˜¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        </div>
        <div class="modal-footer">
            <button class="btn-primary" onclick="confirmDocument('termsModal', 'terms')">í™•ì¸</button>
        </div>
    </div>
</div>

<!-- ê¸ˆë¦¬ì•ˆë‚´ ëª¨ë‹¬ -->
<div id="rateGuideModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>ê¸ˆë¦¬ ì•ˆë‚´</h2>
            <span class="close-btn" onclick="closeModal('rateGuideModal')">&times;</span>
        </div>
        <div class="modal-body">
            <h4>1. ê¸°ë³¸ ê¸ˆë¦¬</h4>
            <p>ê°€ì… ê¸°ê°„ì— ë”°ë¼ ê¸°ë³¸ ê¸ˆë¦¬ê°€ ì°¨ë“± ì ìš©ë©ë‹ˆë‹¤.</p>

            <h4>2. ì¤‘ë„ í•´ì§€ ì´ìœ¨</h4>
            <p>ë§Œê¸° ì „ ì¤‘ë„ í•´ì§€ ì‹œ ì•½ì •ì´ìœ¨ì—ì„œ ì¼ì • ì´ìœ¨ì„ ì°¨ê°í•œ ì¤‘ë„í•´ì§€ ì´ìœ¨ì´ ì ìš©ë©ë‹ˆë‹¤.</p>

            <h4>3. ë§Œê¸° í›„ ì´ìœ¨</h4>
            <p>ë§Œê¸°ì¼ ì´í›„ í•´ì§€í•˜ì§€ ì•Šê³  ë³´ìœ í•˜ëŠ” ê²½ìš° ë§Œê¸°í›„ ì´ìœ¨(ì—° 0.1%)ì´ ì ìš©ë©ë‹ˆë‹¤.</p>

            <h4>4. ê¸ˆë¦¬ ì ìš© ê¸°ì¤€</h4>
            <p>- ê¸ˆë¦¬ëŠ” ì‹ ê·œ ê°€ì…ì¼ ê¸°ì¤€ìœ¼ë¡œ í™•ì •ë©ë‹ˆë‹¤.<br>
                - ì‹œì¥ ê¸ˆë¦¬ ë³€ë™ì— ë”°ë¼ ê¸ˆë¦¬ê°€ ë³€ê²½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        </div>
        <div class="modal-footer">
            <button class="btn-primary" onclick="confirmDocument('rateGuideModal', 'rateGuide')">í™•ì¸</button>
        </div>
    </div>
</div>
<div th:replace="~{cs/chatModal.html}"></div>

<!-- Footer -->
<div th:replace="~{_footer :: footerFragment(${appInfo})}"></div>

<script th:inline="javascript">
    /*<![CDATA[*/
    window.BASE_URL = /*[[@{/}]]*/ "/busanbank/";

    // ë¬¸ì„œ í™•ì¸ ìƒíƒœ ê´€ë¦¬
    const documentChecks = {
        productGuide: false,
        terms: false,
        rateGuide: false
    };

    // ëª¨ë“  ë¬¸ì„œ í™•ì¸ ì—¬ë¶€ ì²´í¬
    function checkAllDocuments() {
        const allChecked = documentChecks.productGuide && documentChecks.terms && documentChecks.rateGuide;
        const completeBtn = document.querySelector('.btn-complete');

        if (allChecked) {
            completeBtn.classList.add('active');
        } else {
            completeBtn.classList.remove('active');
        }
    }

    // ëª¨ë‹¬ ì—´ê¸°
    function openModal(modalId) {
        document.getElementById(modalId).style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
        document.body.style.overflow = '';
    }

    // ë¬¸ì„œ í™•ì¸ ì™„ë£Œ
    function confirmDocument(modalId, docType) {
        // í™•ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸
        documentChecks[docType] = true;

        // í•´ë‹¹ ë¬¸ì„œ ë§í¬ì— confirmed í´ë˜ìŠ¤ ì¶”ê°€
        const docLink = document.querySelector(`[data-doc="${docType}"]`);
        if (docLink) {
            docLink.classList.add('confirmed');
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        closeModal(modalId);

        // ëª¨ë“  ë¬¸ì„œ í™•ì¸ ì—¬ë¶€ ì²´í¬
        checkAllDocuments();
    }

    // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
    window.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal')) {
            e.target.style.display = 'none';
            document.body.style.overflow = '';
        }
    });

    // âœ… ê°€ì… ì™„ë£Œ ì²˜ë¦¬
    function submitJoin() {
        // ëª¨ë“  ë¬¸ì„œë¥¼ í™•ì¸í–ˆëŠ”ì§€ ì²´í¬
        if (!documentChecks.productGuide || !documentChecks.terms || !documentChecks.rateGuide) {
            alert('ìƒí’ˆì„¤ëª…ì„œ, ì•½ê´€, ê¸ˆë¦¬ì•ˆë‚´ë¥¼ ëª¨ë‘ í™•ì¸í•´ì£¼ì„¸ìš”.');
            return;
        }

        // ìµœì¢… ë™ì˜ í™•ì¸
        if (confirm('ìƒí’ˆ ê°€ì…ì„ ì™„ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            console.log('âœ… ê°€ì… ì™„ë£Œ ì²˜ë¦¬ ì‹œì‘');

            // finalAgreeë¥¼ trueë¡œ ì„¤ì •
            document.getElementById('finalAgree').value = 'true';

            // form ì œì¶œ
            document.getElementById('completeForm').submit();
        }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    window.addEventListener('load', function() {
        console.log('âœ… STEP 4 í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
        checkAllDocuments();
    });

    // âœ… ê´‘ê³  ë°°ë„ˆ ìºëŸ¬ì…€
    let currentSlide = 0;
    const slides = document.querySelectorAll('.ad-banner-slide');
    const indicators = document.querySelectorAll('.indicator');

    function showSlide(index) {
        if (index >= slides.length) currentSlide = 0;
        if (index < 0) currentSlide = slides.length - 1;

        slides.forEach(slide => slide.classList.remove('active'));
        indicators.forEach(ind => ind.classList.remove('active'));

        slides[currentSlide].classList.add('active');
        indicators[currentSlide].classList.add('active');
    }

    function changeSlide(direction) {
        currentSlide += direction;
        if (currentSlide >= slides.length) currentSlide = 0;
        if (currentSlide < 0) currentSlide = slides.length - 1;
        showSlide(currentSlide);
    }

    function goToSlide(index) {
        currentSlide = index;
        showSlide(currentSlide);
    }

    // ìë™ ìŠ¬ë¼ì´ë“œ (5ì´ˆë§ˆë‹¤)
    setInterval(() => {
        changeSlide(1);
    }, 5000);
    /*]]>*/
</script>
</body>
</html>